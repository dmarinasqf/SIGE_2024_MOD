(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t(n.DateRangePicker={})})(this,function(n){"use strict";function u(){var n=new Date;return n.setHours(0,0,0,0),n}function f(n,t){return(n&&n.toDateString())===(t&&t.toDateString())}function b(n,t){return n=new Date(n),n.setDate(n.getDate()+t),n}function r(n,t,i){n=new Date(n);var r=n.getDate(),u=n.getMonth()+t;return n.setDate(1),n.setMonth(i?(12+u)%12:u),n.setDate(r),n.getDate()<r&&n.setDate(0),n}function s(n,t){return n=new Date(n),n.setFullYear(n.getFullYear()+t),n}function k(n,t){return n=new Date(n),n.setFullYear(t),n}function d(n,t){return r(n,t-n.getMonth())}function g(n){return function(t){return nt(typeof t=="string"?n(t):t)}}function a(n,t,i){return n<t?t:n>i?i:n}function nt(n){return n=new Date(n),n.setHours(0,0,0,0),n}function h(n,t){var i=undefined;return function(){clearTimeout(i);i=setTimeout(t,n)}}function e(){}function o(){for(var i,r,n=arguments,u=n[0],t=1;t<n.length;++t){i=n[t]||{};for(r in i)u[r]=i[r]}return u}function tt(n){n=n||{};n=o(it(),n);var t=g(n.parse);return n.lang=o(v,n.lang),n.parse=t,n.inRange=rt(n),n.min=t(n.min||s(u(),-100)),n.max=t(n.max||s(u(),100)),n.hilightedDate=n.parse(n.hilightedDate),n}function it(){return{lang:v,mode:"dp-modal",hilightedDate:u(),format:function(n){return n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()},parse:function(n){var t=new Date(n);return isNaN(t)?u():t},dateClass:function(){},inRange:function(){return!0}}}function rt(n){var t=n.inRange;return function(i,r){return t(i,r)&&n.min<=i&&n.max>=i}}function i(n,t,i){return t.addEventListener(n,i,!0),function(){t.removeEventListener(n,i,!0)}}function ft(){var n=window.CustomEvent;return typeof n!="function"&&(n=function(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i},n.prototype=window.Event.prototype),n}function ot(n){var i=n.opts,t=i.lang,o=n.state,e=t.days,s=i.dayOffset||0,c=o.selectedDate,r=o.hilightedDate,h=r.getMonth(),l=u().getTime();return'<div class="dp-cal"><header class="dp-cal-header"><button tabindex="-1" type="button" class="dp-prev">Prev<\/button><button tabindex="-1" type="button" class="dp-cal-month">'+t.months[h]+'<\/button><button tabindex="-1" type="button" class="dp-cal-year">'+r.getFullYear()+'<\/button><button tabindex="-1" type="button" class="dp-next">Next<\/button><\/header><div class="dp-days">'+e.map(function(n,t){return'<span class="dp-col-header">'+e[(t+s)%e.length]+"<\/span>"}).join("")+bt(r,s,function(t){var e=t.getMonth()!==h,o=!i.inRange(t),s=t.getTime()===l,u="dp-day";return u+=e?" dp-edge-day":"",u+=f(t,r)?" dp-current":"",u+=f(t,c)?" dp-selected":"",u+=o?" dp-day-disabled":"",u+=s?" dp-day-today":"",u+=" "+i.dateClass(t,n),'<button tabindex="-1" type="button" class="'+u+'" data-date="'+t.getTime()+'">'+t.getDate()+"<\/button>"})+'<\/div><footer class="dp-cal-footer"><button tabindex="-1" type="button" class="dp-today">'+t.today+'<\/button><button tabindex="-1" type="button" class="dp-clear">'+t.clear+'<\/button><button tabindex="-1" type="button" class="dp-close">'+t.close+"<\/button><\/footer><\/div>"}function st(n,i){var r=n.keyCode,u=r===t.left?-1:r===t.right?1:r===t.up?-7:r===t.down?7:0;r===t.esc?i.close():u&&(n.preventDefault(),i.setState({hilightedDate:b(i.state.hilightedDate,u)}))}function ht(n,t){t.setState({selectedDate:u()})}function ct(n,t){t.setState({selectedDate:null})}function lt(n,t){t.close()}function at(n,t){t.setState({view:"month"})}function vt(n,t){t.setState({view:"year"})}function yt(n,t){var i=t.state.hilightedDate;t.setState({hilightedDate:r(i,1)})}function pt(n,t){var i=t.state.hilightedDate;t.setState({hilightedDate:r(i,-1)})}function wt(n,t){t.setState({selectedDate:new Date(parseInt(n.target.getAttribute("data-date")))})}function bt(n,t,i){var f="",r=new Date(n),u;for(r.setDate(1),r.setDate(1-r.getDay()+t),t&&r.getDate()===t+1&&r.setDate(t-6),u=0;u<42;++u)f+=i(r),r.setDate(r.getDate()+1);return f}function dt(n,t){t.setState({hilightedDate:d(t.state.hilightedDate,parseInt(n.target.getAttribute("data-month"))),view:"day"})}function gt(n){var t=n.opts,i=t.lang,r=i.months,u=n.state.hilightedDate,f=u.getMonth();return'<div class="dp-months">'+r.map(function(n,t){var i="dp-month";return i+=f===t?" dp-current":"",'<button tabindex="-1" type="button" class="'+i+'" data-month="'+t+'">'+n+"<\/button>"}).join("")+"<\/div>"}function ni(n,i){var u=n.keyCode,f=u===t.left?-1:u===t.right?1:u===t.up?-3:u===t.down?3:0;u===t.esc?i.setState({view:"day"}):f&&(n.preventDefault(),i.setState({hilightedDate:r(i.state.hilightedDate,f,!0)}))}function ii(n){var t=n.state,i=t.hilightedDate.getFullYear(),r=t.selectedDate.getFullYear();return'<div class="dp-years">'+fi(n,function(n){var t="dp-year";return t+=n===i?" dp-current":"",t+=n===r?" dp-selected":"",'<button tabindex="-1" type="button" class="'+t+'" data-year="'+n+'">'+n+"<\/button>"})+"<\/div>"}function ri(n,t){t.setState({hilightedDate:k(t.state.hilightedDate,parseInt(n.target.getAttribute("data-year"))),view:"day"})}function ui(n,i){var r=n.keyCode,u=i.opts,f=r===t.left||r===t.up?1:r===t.right||r===t.down?-1:0,e;r===t.esc?i.setState({view:"day"}):f&&(n.preventDefault(),e=s(i.state.hilightedDate,f),i.setState({hilightedDate:a(e,u.min,u.max)}))}function fi(n,t){for(var r="",u=n.opts.max.getFullYear(),i=u;i>=n.opts.min.getFullYear();--i)r+=t(i);return r}function c(n,t,i){function s(){return{get selectedDate(){return u},set selectedDate(n){(!n||i.inRange(n))&&(n?(u=new Date(n),r.state.hilightedDate=u):u=n,r.updateInput(u),t("select"),r.close())},view:"day"}}var o,f=!1,u,r={el:undefined,opts:i,shouldFocusOnBlur:!0,shouldFocusOnRender:!0,state:s(),adjustPosition:e,containerHTML:'<div class="dp"><\/div>',attachToDom:function(){document.body.appendChild(r.el)},updateInput:function(t){var r=new ut("change",{bubbles:!0});r.simulated=!0;n.value=t?i.format(t):"";n.dispatchEvent(r)},computeSelectedDate:function(){return i.parse(n.value)},currentView:function(){return ei[r.state.view]},open:function(){f||(r.el||(r.el=oi(i,r.containerHTML),hi(r)),u=a(r.computeSelectedDate(),i.min,i.max),r.state.hilightedDate=u||i.hilightedDate,r.state.view="day",r.attachToDom(),r.render(),t("open"))},isVisible:function(){return!!r.el&&!!r.el.parentNode},hasFocus:function(){var n=document.activeElement;return r.el&&r.el.contains(n)&&n.className.indexOf("dp-focuser")<0},shouldHide:function(){return r.isVisible()},close:function(i){var u=r.el,e;r.isVisible()&&(u&&(e=u.parentNode,e&&e.removeChild(u)),f=!0,i&&r.shouldFocusOnBlur&&ci(n),setTimeout(function(){f=!1},100),t("close"))},destroy:function(){r.close();o()},render:function(){if(r.el){var t=r.hasFocus(),n=r.currentView().render(r);n&&(r.el.firstChild.innerHTML=n);r.adjustPosition();(t||r.shouldFocusOnRender)&&y(r)}},setState:function(n){for(var i in n)r.state[i]=n[i];t("statechange");r.render()}};return o=si(n,r),r}function oi(n,t){var i=document.createElement("div");return i.className=n.mode,i.innerHTML=t,i}function si(n,t){var r=h(5,function(){t.shouldHide()?t.close():t.open()}),u=[i("blur",n,h(150,function(){t.hasFocus()||t.close(!0)})),i("mousedown",n,function(){n===document.activeElement&&r()}),i("focus",n,r),i("input",n,function(n){var i=t.opts.parse(n.target.value);isNaN(i)||t.setState({hilightedDate:i})}),];return function(){u.forEach(function(n){n()})}}function y(n){var t=n.el.querySelector(".dp-current");return t&&t.focus()}function hi(n){function f(t){t.target.className.split(" ").forEach(function(i){var r=n.currentView().onClick[i];r&&r(t,n)})}var r=n.el,u=r.querySelector(".dp");r.ontouchstart=e;i("blur",u,h(150,function(){n.hasFocus()||n.close(!0)}));i("keydown",r,function(i){if(i.keyCode===t.enter)f(i);else n.currentView().onKeyDown(i,n)});i("mousedown",u,function(t){t.target.focus&&t.target.focus();document.activeElement!==t.target&&(t.preventDefault(),y(n))});i("click",r,f)}function ci(n){n.focus();/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&n.blur()}function li(n,t,i){var r=c(n,t,i);return n.readonly=!0,r.containerHTML+='<a href="#" class="dp-focuser">.<\/a>',r}function ai(n,t,i){var r=c(n,t,i);return r.shouldFocusOnBlur=!1,Object.defineProperty(r,"shouldFocusOnRender",{get:function(){return n!==document.activeElement}}),r.adjustPosition=function(){vi(n,r)},r}function vi(n,t){var i=n.getBoundingClientRect(),r=window;pi(t,i,r);yi(t,i,r);t.el.style.visibility=""}function yi(n,t,i){var r=n.el,u=i.pageXOffset,f=t.left+u,e=i.innerWidth+u,o=r.offsetWidth,h=f+o,s=e-o,c=h>e&&s>0?s:f;r.style.left=c+"px"}function pi(n,t,i){var r=n.el,f=i.pageYOffset,e=f+t.top,o=r.offsetHeight,s=e+t.height+8,h=e-o-8,u=h>0&&s+o>f+i.innerHeight,c=u?h:s;r.classList&&(r.classList.toggle("dp-is-above",u),r.classList.toggle("dp-is-below",!u));r.style.top=c+"px"}function wi(n,t,i){var r=c(n,t,i);return r.close=e,r.destroy=e,r.updateInput=e,r.shouldFocusOnRender=i.shouldFocusOnRender,r.computeSelectedDate=function(){return i.hilightedDate},r.attachToDom=function(){n.appendChild(r.el)},r.open(),r}function bi(n,t,i){return(n=n&&n.tagName?n:document.querySelector(n),i.mode==="dp-modal")?li(n,t,i):i.mode==="dp-below"?ai(n,t,i):i.mode==="dp-permanent"?wi(n,t,i):void 0}function p(){function t(t,i){(n[t]=n[t]||[]).push(i)}function i(n){for(var i in n)t(i,n[i])}var n={};return{on:function(n,r){return r?t(n,r):i(n),this},emit:function(t,i){(n[t]||[]).forEach(function(n){n(t,i)})},off:function(t,i){return t?n[t]=i?(n[t]||[]).filter(function(n){return n!==i}):[]:n={},this}}}function l(n,t){function e(n){r.emit(n,u)}var r=p(),f=tt(t),i=bi(n,e,f),u={get state(){return i.state},on:r.on,off:r.off,setState:i.setState,open:i.open,close:i.close,destroy:i.destroy};return u}function di(n,t){function k(n,t){var i=u.state.hilightedDate,f=s.state.hilightedDate,e=nr(i,f);e!==1&&(t===u?s.setState({hilightedDate:r(t.state.hilightedDate,1)}):u.setState({hilightedDate:r(t.state.hilightedDate,-1)}))}function d(n,t){var r=t.state.selectedDate;!i.start||i.end?a({start:r,end:undefined}):a({start:r>i.start?i.start:r,end:r>i.start?r:i.start})}function a(n){for(var t in n)i[t]=n[t];h.emit("statechange",y);w()}function w(){u.setState({});s.setState({})}function b(n){var t=(i.end||e)&&i.start&&tr(n,i.end||e,i.start),r=f(n,i.start)||f(n,i.end);return(t?"dr-in-range ":"")+(r?"dr-selected ":"")}t=t||{};var h=p(),c=gi(n),e,i={start:undefined,end:undefined},u=l(c.querySelector(".dr-cal-start"),o({},t.startOpts,{mode:"dp-permanent",dateClass:b})),s=l(c.querySelector(".dr-cal-end"),o({},t.endOpts,{mode:"dp-permanent",hilightedDate:r(u.state.hilightedDate,1),dateClass:b})),v={statechange:k,select:d},y={state:i,setState:a,on:h.on,off:h.off};u.on(v);s.on(v);return/iPhone|iPad|iPod/i.test(navigator.userAgent)||c.addEventListener("mouseover",function(n){if(n.target.classList.contains("dp-day")){var t=new Date(parseInt(n.target.dataset.date)),i=!f(t,e);i&&(e=t,w())}}),y}function gi(n){return typeof n=="string"&&(n=document.querySelector(n)),n.innerHTML='<div class="dr-cals"><div class="dr-cal-start"><\/div><div class="dr-cal-end"><\/div><\/div>',n.querySelector(".dr-cals")}function w(n){return n.getYear()*12+n.getMonth()}function nr(n,t){return w(t)-w(n)}function tr(n,t,i){return n<i&&n>=t||n<=t&&n>i}var v={days:["Dom","Lun","Mar","Mier","Jue","Vie","Sab"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre",],today:"Hoy",clear:"Limpiar",close:"Cerrar"},t={left:37,up:38,right:39,down:40,enter:13,esc:27},ut=ft(),et={onKeyDown:st,onClick:{"dp-day":wt,"dp-next":yt,"dp-prev":pt,"dp-today":ht,"dp-clear":ct,"dp-close":lt,"dp-cal-month":at,"dp-cal-year":vt},render:ot},kt={onKeyDown:ni,onClick:{"dp-month":dt},render:gt},ti={render:ii,onKeyDown:ui,onClick:{"dp-year":ri}},ei={day:et,year:ti,month:kt},ki=l;n.TinyDatePicker=ki;n.DateRangePicker=di;Object.defineProperty(n,"__esModule",{value:!0})});